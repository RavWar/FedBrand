- content_for :stylesheets do
  = "#top_ratings { display: none }"

#rating_chart

#rating_dashboard
  %ul
    %li.checkbox &nbsp
    %li.position #
    %li.name= t 'pages.ratings.name'
    %li.emblem &nbsp
    %li.rating= t 'pages.ratings.rating'
    %li.change= t 'pages.ratings.change'

  - last_month = Rating.order('date DESC').first.date.at_beginning_of_month
  - last_month_ratings = Rating.sum('value', include: 'region', conditions: ['date < ?', last_month], group: 'regions.id', order: 'SUM(value) DESC').map(&:first)

  - Rating.top.each_with_index do |(region_id, rating), i|
    - region = Region.find region_id
    - change = last_month_ratings.index(region_id) - i

    %ul.region
      %li.checkbox= check_box_tag 'region', region.id
      %li.position= i+1
      %li.name= region.name
      %li.emblem= image_tag region.emblem.url(:icon)
      %li.rating= rating
      %li.change= change > 0 ? "+#{change}" : "#{change}"